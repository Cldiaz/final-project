<% include ../partials/header.ejs %>
<% include ../partials/navbar.ejs %>
<main class="container">
<div class="white-bg">  
    <h1>Edit Ticket <%= ticket.ticketNumber %></h1>

    <form method="post">
        <fieldset class="form-group">
            <label for="ticketTitle" class="col-sm-2">Ticket Title: *</label>
            <input type="text" name="ticketTitle" required value="<%= ticket.ticketTitle %>" disabled/>
        </fieldset>
        <fieldset class="form-group">
            <label for="ticketDescription" class="col-sm-2">Ticket Description: *</label>
            <textarea name="ticketDescription" rows="5" required disabled><%= ticket.ticketDescription %></textarea />
        </fieldset>


        <fieldset class="form-group">
            <label for="ticketPriority" class="col-sm-2">Ticket Priority: *</label>
            <select  name="ticketPriority" id="sel1" disabled>
                <% if (ticket.ticketPriority == 'HIGH') { %>
                <option>LOW</option>
                <option>MEDIUM</option>
                <option selected>HIGH</option>
                <% } else if (ticket.ticketPriority == 'MEDIUM') {%>
                <option>LOW</option>
                <option selected>MEDIUM</option>
                <option>HIGH</option>
                <% } else {%>
                <option selected>LOW</option>
                <option>MEDIUM</option>
                <option>HIGH</option>
                <% } %>
            </select>
        </fieldset>
        
        <fieldset class="form-group">
            <label for="customerName" class="col-sm-2">Customer Name: *</label>
            <input type="text" name="customerName" required value="<%= ticket.customerName %>"disabled/>
        </fieldset>
        
        <fieldset class="form-group">
            <label for="customerPhone" class="col-sm-2">Customer Phone: *</label>
            <input type="text" name="customerPhone" required value="<%= ticket.customerPhone %>"disabled/>
        </fieldset>
        <% if (ticket.incidentNarrative[ticket.incidentNarrative.length - 1].ticketStatus  == 'CLOSED') { %>
        <fieldset class="form-group">
            <label for="ticketStatus" class="col-sm-2">Ticket Status: *</label>
            <select  name="ticketStatus" id="sel2" disabled>
                <option>NEW</option>
                <option>IN PROGRESS</option>
                <option selected>CLOSED</option>
            </select>
        </fieldset>
        
        <fieldset class="form-group">
            <label for="comment" class="col-sm-2">Comment: *</label>
            <textarea name="comment" rows="5" required disabled></textarea />
        </fieldset>
        
        <% } else if (ticket.incidentNarrative[ticket.incidentNarrative.length - 1].ticketStatus  == 'IN PROGRESS') {%>
        <fieldset class="form-group">
            <label for="ticketStatus" class="col-sm-2">Ticket Status: *</label>
            <select  name="ticketStatus" id="sel2">
                <option>NEW</option>
                <option selected>IN PROGRESS</option>
                <option>CLOSED</option>
            </select>
        </fieldset>
        
        <fieldset class="form-group">
            <label for="comment" class="col-sm-2">Comment: *</label>
            <textarea name="comment" rows="5" required></textarea />
        </fieldset>
        <% } else { %>
        <fieldset class="form-group">
            <label for="ticketStatus" class="col-sm-2">Ticket Status: *</label>
            <select  name="ticketStatus" id="sel2">
                <option>NEW</option>
                <option>IN PROGRESS</option>
                <option>CLOSED</option>
            </select>
        </fieldset>
        
        <fieldset class="form-group">
            <label for="comment" class="col-sm-2">Comment: *</label>
            <textarea name="comment" rows="5" required></textarea />
        </fieldset>
        <% } %>
        
        <p>Incident Narrative:</p>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Comment</th>
                </tr>
            </thead>
            <tbody>
                <% for (var i = 0; i < ticket.incidentNarrative.length; i++) { %>
                    <tr>
                        <td><%= ticket.incidentNarrative[i].commentDate.toDateString() %></td>
                        <td><%= ticket.incidentNarrative[i].ticketStatus %></td>
                        <td><%= ticket.incidentNarrative[i].comment %></td>
                    </tr>
                <% } %>
            </tbody>
        </table>
        
        <fieldset class="form-group text-right">
            <button type="submit" class="col-sm-offset-2 btn btn-success">Submit</button>
            <a href="/">
                <input type="button" class="btn btn-warning" value="Cancel"/>
            </a>
            <input type="reset" class="btn btn-warning" value="Restet"/>
        </fieldset>
    </form>
</div> <!--./white-bg-->
</main>
<% include ../partials/footer.ejs %>